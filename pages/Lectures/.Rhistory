estimation_data <- ch10data %>%
filter(date > as.Date("1968-12-01") & date < as.Date("1994-12-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- 1:length(y)     # time indices
time
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1968-12-01") & date < as.Date("1994-12-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- 1:length(y)     # time indices
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2=time^2, model.matrix(~seasonal-1))
reg <- arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE)
summary(reg)
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-12-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- 1:length(y)     # time indices
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2=time^2, model.matrix(~seasonal-1))
reg <- arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE)
summary(reg)
reg <- arima(y, order=c(3, 0, 0), xreg=as.factor(month(estimation_data$date)), include.mean=FALSE)
summary(reg)
reg <- arima(y, order=c(3, 0, 0), xreg=as.factor(month(estimation_data$date)), include.mean=FALSE)
X <- cbind(time, time2=time^2, model.matrix(~seasonal-1))
reg <- arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE)
summary(reg)
reg <- arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE, method = "CSS")
summary(reg)
auto.arima(y)
arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE, method = "CSS", trace=T)
arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE, method = "CSS")
arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE, method = "CSS-ML")
arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE, method = "ML")
plot(y, type = "l")
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-12-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- 1:length(y)     # time indices
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2=time^2, model.matrix(~seasonal-1))
reg <- arima(y, order=c(3, 0, 0), xreg=X, include.mean=FALSE)
summary(reg)
plot(y, type = "l")
lines(y - residuals(reg), lty=2)
lines(y - residuals(reg), lty=2, col="red")
plot(estimation_data$date,y, type = "l")
lines(y - residuals(reg), lty=2, col="red")
plot(estimation_data$date, y, type = "l")
lines(estimation_data$date, y - residuals(reg), lty=2, col="red")
X
head(X)
estimation_data %<>%
mutate(ar1=lag(lsales, 1),
ar2=lag(lsales, 2),
ar3=lag(lsales, 3))
head(estimation_data)
X1 <- cbind(estimation_data[,-1:-2])
head(X1)
X1 <- cbind(estimation_data[,-1:-2], X)
head(X1)
lm(lsales~-1, data = X1)
lm(lsales~.-1, data = X1)
summary(lm(lsales~.-1, data = X1))
summary(reg)
plot(estimation_data$date, y, type = "l")
lines(estimation_data$date, y - residuals(reg),
lty = 2,
col = "red")
summary(reg1 <- lm(lsales~.-1, data = X1))
reg1
lines(estimation_data$date, fitted(reg1),
lty = 2,
col = "blue")
lines(estimation_data$date[-1:2], fitted(reg1),
lty = 2,
col = "blue")
plot(estimation_data$date, y, type = "l")
lines(estimation_data$date, y - residuals(reg),
lty = 2,
col = "red")
lines(estimation_data$date[-1:2], fitted(reg1),
lty = 2,
col = "blue")
lines(estimation_data$date, c(NA, NA, fitted(reg1)),
lty = 2,
col = "blue")
lines(estimation_data$date, c(NA, NA, NA, fitted(reg1)),
lty = 2,
col = "blue")
plot(estimation_data$date, y, type = "l")
lines(estimation_data$date, y - residuals(reg),
lty = 2,
col = "red")
lines(estimation_data$date, c(NA, NA, NA, fitted(reg1)),
lty = 2,
col = "blue")
plot(estimation_data$date, y, type = "l")
lines(estimation_data$date, y - residuals(reg),
lty = 2,
col = "red")
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-12-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X)
summary(reg)
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-12-01"))
estimation_data %<>% mutate(lsales = log(liquor))
estimation_data
estimation_data
estimation_data <- ch10data %>%
mutate(time=row_number()) %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-12-01"))
estimation_data
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- estimation_data$time
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
ch10data
estimation_data <- ch10data %>%
mutate(time=row_number()) %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- estimation_data$time
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
estimation_data <- ch10data %>%
mutate(time=row_number(), lsales = log(liquor)) %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data
estimation_data <- ch10data %>%
mutate(time=row_number()-1) %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data %<>% mutate(lsales = log(liquor))
y <- estimation_data$lsales
time <- estimation_data$time
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
y <- estimation_data$lsales
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
library(dplyr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data$lsales <- log(estimation_data$liquor))
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data$lsales <- log(estimation_data$liquor))
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data$lsales <- log(estimation_data$liquor)
estimation_data
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data$lsales <- log(estimation_data$liquor)
estimation_data
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
X
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
plot(estimation_data$lsales, y, type = "l", lwd = 2)
plot(estimation_data$date, y, type = "l", lwd = 2)
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
plot(estimation_data$date, y, type = "l", lwd = 2)
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data$lsales <- log(estimation_data$liquor)
estimation_data
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
##House Keeping
rm(list=ls())
library(dplyr)
library(magrittr)
library(lubridate)
load("~/ecn321/pages/Lectures/ch10data.Rdata")
estimation_data <- ch10data %>%
filter(date > as.Date("1967-12-01") & date < as.Date("1994-01-01"))
estimation_data$lsales <- log(estimation_data$liquor)
estimation_data
time <- 1:length(y)
y <- estimation_data$lsales
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
model.matrix(~seasonal - 1)
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
y <- estimation_data$lsales
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
library(dygraphs)
dygraph(nhtemp, main = "New Haven Temperatures") %>%
dyRangeSelector(dateWindow = c("1920-01-01", "1960-01-01"))
y <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
library(dygraphs)
y <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
y - residuals(reg)
y <- estimation_data$lsales
time <- 1:length(y)
seasonal <- as.factor(month(estimation_data$date))
X <- cbind(time, time2 = time^2, model.matrix(~seasonal - 1))
reg <- arima(y, order = c(3, 0, 0), xreg = X, include.mean = FALSE)
summary(reg)
plot(estimation_data$date, y, type = "l", lwd = 2, xlab = "Time")
lines(estimation_data$date, y - residuals(reg), lty = 2, col = "red")
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
lungDeaths <- cbind(y, fdeaths)
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
lungDeaths <- cbind(y1, fit)
dygraph(lungDeaths)
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
lungDeaths <- cbind(y1, fit)
dygraph(lungDeaths)
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model)
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>% dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>% dyRangeSelector()%>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1"))
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Male") %>%
dySeries("fit", label = "Female")
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Male") %>%
dySeries("fit", label = "Female") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Series") %>%
dySeries("fit", label = "Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set2")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set3")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesBackgroundAlpha = 0.2,
hideOnMouseOut = FALSE) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Log of Liquor sales") %>%
dySeries("fit", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Log of Liquor sales") %>%
dySeries("fit", strokePattern = "dashed", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("fit", strokePattern = "dashed", label = "Model Fit") %>%
dySeries("y1", label = "Log of Liquor sales") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Log of Liquor sales") %>%
dySeries("fit", strokePattern = "dashed", label = "Model Fit") %>%
dyOptions(colors = RColorBrewer::brewer.pal(2, "Set1")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyRangeSelector()
library(dygraphs)
y1 <- ts(y, start = c(1968, 1), frequency = 12)
fit <- ts(y - residuals(reg),start = c(1968, 1), frequency = 12)
model <- cbind(y1, fit)
dygraph(model) %>%
dySeries("y1", label = "Log of Liquor sales") %>%
dySeries("fit", strokePattern = "dashed", label = "Model Fit") %>%
dyOptions(colors = c("#CC79A7", "#009E73")) %>%
dyHighlight(highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyRangeSelector()
load('ch9data.Rdata')
plot(ch9data$date, ch9data$caemp, type = "l")
estimation_data <- ch9data %>%
filter(date < as.Date("1994-01-01") )
y <- estimation_data$caemp
ar2 <- arima(y, order=c(2,0,0))
ar2
library(forecast)
library(data.table)
setDT(ch9data)[, eval := date>as.Date("1993-04-01"),]
h <- sum(ch9data$eval)
fcst <- forecast(ar2, h=h)
ch9data$fit <- c(y-residuals(ar2), rep(NA, h-2))
ch9data[eval==TRUE, hi:=fcst$upper[,2],]
ch9data[eval==TRUE, lo:=fcst$lower[,2],]
ch9data[eval==TRUE, f:=fcst$mean,]
plot_data <-  ch9data %>% filter(date>as.Date("1989-12-01"))
plot(plot_data$date, plot_data$caemp, type='l', ylim=c(70, 120))
lines(plot_data$date, plot_data$fit, col="blue")
lines(plot_data$date, plot_data$f, col="red")
lines(plot_data$date, plot_data$hi, col="red", lty=2)
lines(plot_data$date, plot_data$lo, col="red", lty=2)
library(dygraphs)
a <- as.xts.data.table(as.data.table(ch9data))
dygraph(a, main = "Canadian Employment Index") %>%
dyRangeSelector() %>%
dySeries(name = "caemp", label = "Actual") %>%
dySeries(c("hi","f", "lo"), label = "Predicted") %>%
dyLegend(show = "always", hideOnMouseOut = FALSE) %>%
dyHighlight(highlightCircleSize = 5,
highlightSeriesOpts = list(strokeWidth = 2)) %>%
dyOptions(axisLineColor = "navy", gridLineColor = "grey")
