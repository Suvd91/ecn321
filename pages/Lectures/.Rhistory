housing <- ch6data %>%
select(date, hstarts) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
plot(housing$date, housing$dgs, type = "l")
plot(housing$date, housing$hstarts, type = "l")
D<-seasonal.dummies(house_starts)
plot(USAccDeaths)
fit <- stl(USAccDeaths, s.window="periodic")
lines(trendcycle(fit),col="red")
library(forecast)
plot(USAccDeaths)
fit <- stl(USAccDeaths, s.window="periodic")
lines(trendcycle(fit),col="red")
library(ggplot2)
autoplot(cbind(
Data=USAccDeaths,
Seasonal=seasonal(fit),
Trend=trendcycle(fit),
Remainder=remainder(fit)),
facets=TRUE) +
ylab("") + xlab("Year")
install.packages("uroot")
mydata<-filter(ch6data,between(Date,as.Date("1946-01-01"),as.Date("1994-11-01")))
mydata<-filter(ch6data,between(date,as.Date("1946-01-01"),as.Date("1994-11-01")))
house.starts<-ts(mydata$hstarts,start = c(1946,1),end = c(1994,11),frequency = 12)
house_starts<-head(house.starts,576)
house_starts2<-tail(house.starts,59)
# Figure 6.4 Housing starts, 1946.01-1994.11
plot.ts(house_starts,ylab="Starts",main="Figure 6.4 Housing Starts 1946.01-1994.11",bty="l"
,ylim=c(0,250),yaxt="n",xaxt="n",type="l",lwd=2)
axis(2,at=c(seq(0,250,50)),labels = c(seq(0,250,50)),las=1)
axis(1,at=c(seq(1950,1990,5)),labels = c(seq(50,90,5)))
D<-seasonal.dummies(house_starts)
D<-uroot::seasonal.dummies(house_starts)
reg1<-lm(house_starts~D-1)
View(D)
result1<-summary(reg1)
result1$coefficients
load("ch6data.Rdata")
View(ch6data)
library(dplyr)
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
plot(housing$date, housing$hstarts, type = "l")
mydata<-filter(ch6data,between(date,as.Date("1946-01-01"),as.Date("1994-11-01")))
house.starts<-ts(mydata$hstarts,start = c(1946,1),end = c(1994,11),frequency = 12)
house_starts<-head(house.starts,576)
house_starts2<-tail(house.starts,59)
house.starts<-ts(mydata$hstarts,start = c(1946,1),end = c(1994,11),frequency = 12)
house_starts<-head(house.starts,576)
house_starts2<-tail(house.starts,59)
house_starts
View(housing)
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
plot(housing$date, housing$hstarts, type = "l")
# Figure 6.4 Housing starts, 1946.01-1994.11
plot.ts(house_starts,ylab="Starts",main="Figure 6.4 Housing Starts 1946.01-1994.11",bty="l"
,ylim=c(0,250),yaxt="n",xaxt="n",type="l",lwd=2)
axis(2,at=c(seq(0,250,50)),labels = c(seq(0,250,50)),las=1)
axis(1,at=c(seq(1950,1990,5)),labels = c(seq(50,90,5)))
D<-uroot::seasonal.dummies(house_starts)
reg1<-lm(house_starts~D-1)
result1<-summary(reg1)
result1$coefficients
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts~seasonal)
res1 <- lm(hstarts~seasonal, data=housing)
res1
res1 <- lm(hstarts~seasonal - 1, data=housing)
res1
reg1
house_starts
View(estimation_data)
res1 <- lm(hstarts ~ seasonal - 1, data=estimation_data)
res1
reg1
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts ~ seasonal - 1, data = estimation_data)
res1
knitr::opts_chunk$set(echo = TRUE)
load("ch6data.Rdata")
library(dplyr)
gasoline <- ch6data %>%
select(date, gs) %>%
filter(date >= as.Date("1980-01-01") & date <= as.Date("1992-01-01") )
plot(gasoline$date, gasoline$gs, type = "l")
liquor <- ch6data %>%
select(date, ls) %>%
filter(date >= as.Date("1980-01-01") & date <= as.Date("1992-01-01") )
plot(liquor$date, liquor$ls, type = "l")
durables <- ch6data %>%
select(date, dgs) %>%
filter(date >= as.Date("1980-01-01") & date <= as.Date("1992-01-01") )
plot(durables$date, durables$dgs, type = "l")
stargazer(res, type = "html")
library(stargazer)
stargazer(res, type = "html")
stargazer(res1, type = "html")
load("ch6data.Rdata")
library(dplyr)
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
plot(housing$date, housing$hstarts, type = "l")
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts ~ seasonal - 1, data = estimation_data)
library(stargazer)
stargazer(res1, type = "html")
stargazer(res1, type = "text")
stargazer(res1, type = "text", add.lines = list(c("AIC", AIC(res1)))
stargazer(res1, type = "text", add.lines = list(c("AIC", AIC(res1)))
)
stargazer(res1, type = "text", add.lines = list(c("AIC", AIC(res1))))
stargazer(res1, type = "text",
add.lines = list(c("AIC", AIC(res1)),
c("BIC", BIC(res1)))
)
install.packages("memisc")
library(memisc)
mtable(res1)
install.packages("texreg")
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts ~ seasonal - 1, data = estimation_data)
library(stargazer)
stargazer(res1,
type = "html",
add.lines = list(c("AIC", AIC(res1)),
c("BIC", BIC(res1)))
)
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts ~ seasonal - 1, data = estimation_data)
#library(stargazer)
#stargazer(res1,
#type = "html",
#add.lines = list(c("AIC", AIC(res1)),
#                 c("BIC", BIC(res1)))
#)
plot(hstarts ~ date, data =  evaluation_data,
type = "l",
lwd = 2,
xlab = "Time",
ylab="Sales",
main = "Monthly Retail Sales: 1955.01-1993.12")
plot(hstarts ~ date, data =  estimation_data,
type = "l",
lwd = 2,
xlab = "Time",
ylab="Sales",
main = "Monthly Retail Sales: 1955.01-1993.12")
lines(estimation_data$date, fitted(res1), col="blue", lty=2)
lines(estimation_data$date, fitted(res1), col="blue", lty=2,lwd=2)
legend("topleft", c("Actual", "Fitted"),
lty = c(1, 2),
col = c("black", "blue"))
legend("topleft", c("Actual", "Fitted"),
lty = c(1, 2),
col = c("black", "blue"), cex=0.6)
plot(hstarts ~ date, data =  estimation_data,
type = "l",
lwd = 2,
xlab = "Time",
ylab="Sales",
main = "Monthly Retail Sales: 1955.01-1993.12")
lines(estimation_data$date, fitted(res1), col="blue", lty=2,lwd=2)
legend("topleft", c("Actual", "Fitted"),
lty = c(1, 2),
col = c("black", "blue"), cex=0.6)
plot(hstarts ~ date, data =  estimation_data,
type = "l",
lwd = 2,
xlab = "Time",
ylab="Sales",
main = "Monthly Retail Sales: 1955.01-1993.12")
lines(estimation_data$date, fitted(res1), col="blue", lty=2,lwd=2)
legend("topright", c("Actual", "Fitted"),
lty = c(1, 2),
col = c("black", "blue"), cex=0.6)
plot(residuals(res1), type = "l",
xlab = "",
ylab = "",
main = "Residuals",
col  = "green4", )
hist(residuals(loglinear), probability = TRUE, breaks = 20,
main = "Histogram of Residuals",
col  = "steelblue4",
xlab = "Residuals")
plot(residuals(res1), type = "l",
xlab = "",
ylab = "",
main = "Residuals",
col  = "green4", )
hist(residuals(res1), probability = TRUE, breaks = 20,
main = "Histogram of Residuals",
col  = "steelblue4",
xlab = "Residuals")
plot(reg1$coefficients,main="Figure 6.7 Estimated seasonal factors, housing starts",type="l"
,lwd=2,yaxt="n",xlab="Season",ylab="Seasonal factors",ylim=c(80,160),bty="l")
plot(res1$coefficients,main="Figure 6.7 Estimated seasonal factors, housing starts",type="l"
,lwd=2,yaxt="n",xlab="Season",ylab="Seasonal factors",ylim=c(80,160),bty="l")
barplot(res1$coefficients)
plot(res1$coefficients,main="Figure 6.7 Estimated seasonal factors, housing starts",type="l"
,lwd=2,yaxt="n",xlab="Season",ylab="Seasonal factors",ylim=c(80,160),bty="l")
axis(2,at=c(seq(80,160,20)),labels = c(seq(80,160,20)),las=2)
paste0("s", 1:12)
barplot(res1$coefficients, names.arg=paste0("s", 1:12))
barplot(res1$coefficients, names.arg=paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients+0.4 , paste("n: ", res1$coefficients, sep="") ,cex=1)
bar <- barplot(res1$coefficients, names.arg=paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients+0.4 , paste("n: ", res1$coefficients, sep="") ,cex=1)
signif(res1$coefficients)
signif(res1$coefficients, 1)
signif(res1$coefficients, 2)
signif(res1$coefficients, 3)
text(bar, res1$coefficients+0.4 , signif(res1$coefficients, 3) ,cex=1)
bar <- barplot(res1$coefficients, names.arg=paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients+0.4 , signif(res1$coefficients, 3) ,cex=1)
bar <- barplot(res1$coefficients, names.arg=paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients+0.4 , signif(res1$coefficients, 3) ,cex=1)
bar <- barplot(res1$coefficients, names.arg=paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients+0.4 , signif(res1$coefficients, 3) ,cex=1)
bar <- barplot(res1$coefficients, names.arg=paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients , signif(res1$coefficients, 3) , cex=0.7)
## Forecasts
View(evaluation_data)
View(estimation_data)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
View(ch6data)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
View(ch6data)
plot(res1$coefficients,main="Figure 6.7 Estimated seasonal factors, housing starts",type="l"
,lwd=2,yaxt="n",xlab="Season",ylab="Seasonal factors",ylim=c(80,160),bty="l")
axis(2,at=c(seq(80,160,20)),labels = c(seq(80,160,20)),las=2)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
library(dplyr)
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
load("ch6data.Rdata")
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
# Application: Forecasting Housing Starts
ch6data
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
load("ch6data.Rdata")
library(dplyr)
# Application: Forecasting Housing Starts
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
plot(housing$date, housing$hstarts, type = "l")
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts ~ seasonal - 1, data = estimation_data)
plot(hstarts ~ date, data =  estimation_data,
type = "l",
lwd = 2,
xlab = "Time",
ylab="Sales",
main = "Monthly Retail Sales: 1955.01-1993.12")
lines(estimation_data$date, fitted(res1), col="blue", lty=2,lwd=2)
legend("topright", c("Actual", "Fitted"),
lty = c(1, 2),
col = c("black", "blue"), cex=0.6)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot(plot_data$date, plot_data$hstarts, type = "l")
View(plot_data)
View(estimation_data)
View(plot_data)
View(ch6data)
knitr::opts_chunk$set(echo = TRUE)
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(60, 140,  140, 60), col = "grey85", border = NA)
plot(plot_data$date, plot_data$hstarts, type = "l")
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(60, 140,  140, 60), col = "grey85", border = NA)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot(plot_data$date, plot_data$hstarts, type = "l")
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot(plot_data$date, plot_data$hstarts, type = "l")
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(60, 140,  140, 60), col = "grey85", border = NA)
lines(plot_data$date, plot_data$rtrr, lwd = 2)
# interval forecasts
lower <- point_forecasts - 1.96*summary(reg1)$sigma
plot(plot_data$date, plot_data$hstarts, type = "l")
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(60, 140,  140, 60), col = "grey85", border = NA)
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(60, 150,  150, 60), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
point_forecasts
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
lines(point_forecasts, type = "l", lwd=2, col="red")
lines(test$date , point_forecasts, type = "l", col = "red", lwd=2, lty=2)
lines(evaluation_data$date , point_forecasts, type = "l", col = "red", lwd=2, lty=2)
lines(evaluation_data$date , lower, type = "l", col = "red", lty = 2)
lines(evaluation_data$date , upper, type = "l", col = "red", lty = 2)
plot(plot_data$date, plot_data$hstarts, type = "l", ylim=c(50, 160))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(60, 150,  150, 60), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
lines(evaluation_data$date , point_forecasts, type = "l", col = "red", lwd=2, lty=2)
lines(evaluation_data$date , lower, type = "l", col = "red", lty = 2)
lines(evaluation_data$date , upper, type = "l", col = "red", lty = 2)
max(upper)
min(lower)
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
plot(plot_data$date, plot_data$hstarts, type = "l", ylim=c(30, 210))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
lines(evaluation_data$date , point_forecasts, type = "l", col = "red", lwd=2, lty=2)
lines(evaluation_data$date , lower, type = "l", col = "red", lty = 2)
lines(evaluation_data$date , upper, type = "l", col = "red", lty = 2)
plot(plot_data$date, plot_data$hstarts, type = "l", ylim=c(30, 210))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
plot(plot_data$date, type = "l", ylim=c(30, 210))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
plot(plot_data$date, type = "l", ylim=c(30, 210))
plot(plot_data$date, plot_data$hstarts, type = "l", ylim=c(30, 210))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
lines(evaluation_data$date , point_forecasts, type = "l", col = "red", lwd=2, lty=2)
lines(evaluation_data$date , lower, type = "l", col = "red", lty = 2)
lines(evaluation_data$date , upper, type = "l", col = "red", lty = 2)
load("/home/khashaa/Downloads/ch6data.Rdata")
View(ch6data)
View(ch6data)
library(haven)
ws_khoroo_Xs_entry08_aug_10perc <- read_dta("~/Downloads/ws_khoroo_Xs_entry08_aug_10perc.dta")
View(ws_khoroo_Xs_entry08_aug_10perc)
View(ws_khoroo_Xs_entry08_aug_10perc)
View(ws_khoroo_Xs_entry08_aug_10perc)
setwd("~/ecn321/pages/Lectures")
options(htmltools.dir.version = FALSE)
load("ch6data.Rdata")
library(dplyr)
load("ch6data.Rdata")
library(dplyr)
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
load("ch6data.Rdata")
library(dplyr)
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
xtable::xtable(head(housing))
View(housing)
knitr::kable(head(housing), type="html")
knitr::kable(head(housing, 10))
knitr::kable(head(housing[,1:2], 10))
load("ch6data.Rdata")
library(dplyr)
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
knitr::kable(head(housing[,1:2], 10))
load("ch6data.Rdata")
library(dplyr)
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
housing <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1946-01-01") & date <= as.Date("1994-11-01"))
plot(housing$date, housing$hstarts, type = "l")
plot(housing$date, housing$hstarts, type = "l", ylab="Starts", xlab = "Time")
plot(housing$date, housing$hstarts, type = "l", ylab="Starts", xlab = "Time", lwd = 2)
estimation_data <- housing[1:576,]
evaluation_data <- housing[-1:-576,]
res1 <- lm(hstarts ~ seasonal - 1, data = estimation_data)
knitr::kable(broom::tidy(res1)))
knitr::kable(broom::tidy(res1)))
broom::tidy(res1)
knitr::kable(broom::tidy(res1))
knitr::opts_chunk$set(echo = TRUE)
plot(hstarts ~ date, data =  estimation_data,
type = "l",
lwd = 2,
xlab = "Time",
ylab="Sales",
main = "Monthly Retail Sales: 1955.01-1993.12")
lines(estimation_data$date, fitted(res1), col="blue", lty=2,lwd=2)
legend("topright", c("Actual", "Fitted"),
lty = c(1, 2),
col = c("black", "blue"), cex=0.6)
summary(res1)
plot(residuals(res1), type = "l",
xlab = "",
ylab = "",
main = "Residuals",
col  = "green4", )
hist(residuals(res1), probability = TRUE, breaks = 20,
main = "Histogram of Residuals",
col  = "steelblue4",
xlab = "Residuals")
bar <- barplot(res1$coefficients, names.arg = paste0("s", 1:12), border=FALSE)
text(bar, res1$coefficients , signif(res1$coefficients, 3) , cex=0.7)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot(plot_data$date, plot_data$hstarts,
type = "l",
ylim = c(30, 210))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
lines(evaluation_data$date , point_forecasts,
type = "l",
col = "red",
lwd=2,
lty=2)
lines(evaluation_data$date , lower,
type = "l",
col = "red",
lty = 2)
lines(evaluation_data$date , upper, type = "l", col = "red", lty = 2)
plot_data <- ch6data %>%
select(date, hstarts, seasonal) %>%
filter(date >= as.Date("1990-01-01") & date <= as.Date("1994-11-01"))
plot(plot_data$date, plot_data$hstarts,
type = "l",
xlab = "Time",
ylab="History, Forecasts, Realization",
ylim = c(30, 210))
polygon(c(as.Date("1994-01-01") ,  as.Date("1994-01-01"), as.Date("1994-11-01"), as.Date("1994-11-01")),
c(30, 210,  210, 30), col = "grey85", border = NA)
lines(plot_data$date, plot_data$hstarts, lwd = 2)
point_forecasts <- predict(res1, evaluation_data)
# interval forecasts
lower <- point_forecasts - 1.96*summary(res1)$sigma
upper <- point_forecasts + 1.96*summary(res1)$sigma
lines(evaluation_data$date , point_forecasts,
type = "l",
col = "red",
lwd=2,
lty=2)
lines(evaluation_data$date , lower,
type = "l",
col = "red",
lty = 2)
lines(evaluation_data$date , upper, type = "l", col = "red", lty = 2)
