<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Эконометрикс II</title>
    <meta charset="utf-8" />
    <meta name="author" content="багш: Д. Хашбаатар" />
    <link href="slide5_files/remark-css/default.css" rel="stylesheet" />
    <link href="slide5_files/remark-css/metropolis.css" rel="stylesheet" />
    <link href="slide5_files/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="my-css.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Эконометрикс II
## Лекц 6: Мөчлөгийг тодорхойлох
<html>
<div style="float:left">

</div>
<hr color='#EB811B' size=1px width=796px>
</html>
### багш: Д. Хашбаатар
### 2019/09/23

---






# Мөчлөгийг загварчлах

.hi[Хугацаан цуваа]
`$$y_t=Trend_t + {Seasonal}_t + \color{#e64173}{Ciclyc_t} + \varepsilon_t$$`
&gt;.small[.hi-pink[Мөчлөг]: Динамик хамаарал нь тогтвортой байх хугацаан цуваа.]


--

*Динамик хамаарал*: .hi-pink[Автокорреляц]

--

*Tогтвортой*: .hi-pink[стационарь]

---
# Нэршил, Тодорхойлолт
 
.hi-pink[realization (илэрц)]: 
 - Цаг хугацааны дагуу дугаарлагдсан цуваа `\(\{\ldots,y_{-1},y_0,y_1,\ldots\}\)`

.hi-pink[sample path (түүвэр)]: 
 - цувааны ажиглагдсан утгууд `\(y_1,\ldots,y_T\)`

.hi-pink[lag(хоцрол)]: 
 - Хугацаан цувааны өмнөх утгууд. `\(y_t\)`-ийн `\(j\)`-р хоцрол нь `\(y_{t-j}\)`. 

.hi-pink[difference]:
 - `\(\Delta y_t=y_t-y_{t-1}\)`
 

---
# Нэршил, Тодорхойлолт

.hi-pink[Дундаж]: `$$\mathrm{E}(y_t)=\mu_t$$`

.hi-pink[Автоковариацийн функц (Autocovariance)]: `$$\gamma(t, h)=\mathrm{Cov}(y_t, y_{t-h})$$`
--

 - Автоковариацийн функц `\(t\)`-с хамаарахгүй бол `\(\gamma(h)=\mathrm{Cov}(y_t, y_{t-h})\)`.
 
--
 
 - `\(\gamma(0)=\mathrm{Cov}(y_t, y_{t})=\mathrm{Var}(y_t)\)`

--

.hi-pink[Автокорреляцийн функц (Autocorrelation)]: `$$\rho(h) \equiv \frac{\gamma(h)}{\gamma(0)}$$`
 - `\(\rho(h)\neq 0\)` бол автокорреляц хамааралтай цуваа

---
class: clear

.hi-slate[Эерэг автокорреляц хамаарал] 
&lt;img src="slide5_files/figure-html/positive auto u-1.svg" style="display: block; margin: auto;" /&gt;
---
class: clear

.hi-slate[Сөрөг автокорреляц хамаарал]
&lt;img src="slide5_files/figure-html/negative auto u-1.svg" style="display: block; margin: auto;" /&gt;

---
# Стационарь цуваа

&gt; Хугацаан цувааны эхний 2 момент нь `\(t\)`-ээс үл хамаарах бол .hi[стационар цуваа (covariance stationary)] гэнэ. Өөрөөр хэлбэл дараах 2 нөхцлийг хангана.
 1. `$$\mathrm{E}(y_t)=\mu$$`
 2. `$$\gamma(h)=\mathrm{Cov}(y_t, y_{t-h})&lt;\infty$$`

---
# White noise

 - Дундаж нь 0 байх, авкорреляц хамааралгүй хугацаан цувааг .hi-pink[white noise] (.small[цагаан шуугиан]) гэдэг.

 - `\(\varepsilon_t\sim WN(0,\sigma^2)\)`

  - `\(\mathrm{E}(\varepsilon_t)=0\)`
  - `\(\mathrm{Var}(\varepsilon_t)=\sigma^2\)`
  - `\(\rho(h)=0,\quad h&gt;1\)`
  
--

Нөхцөлт дундаж болон вариацын хувьд ( `\(\Omega_t=\{\varepsilon_t,\varepsilon_{t-1},\ldots \}\)`)

 - `\(\mathrm{E}(\varepsilon_t|\Omega_{t−1})=0\)`
 - `\(\mathrm{Var}(\varepsilon_t|\Omega_{t−1} )=\mathrm{E}\{(\varepsilon_t−\mathrm{E}(\varepsilon_t|\Omega_{t−1}))^2|\Omega_{t−1}\}=\sigma^2\)`

---
class: clear
.hi-slate[Realization of White Noise]
&lt;img src="slide5_files/figure-html/wn-1.svg" style="display: block; margin: auto;" /&gt;

---
# Ухраах оператор Lag operator
`$$L(y_t)=y_{t-1},\quad L(L(y_t))=L^2(y_t)=y_{t-2}, \quad L^m(y_t)=y_{t-m}$$`


## Ухраах операторын олон гишүүнт

`$$B(L)=b_0+b_1L+b_2L^2+\cdots+b_mL^m$$`


`$$B(L)=b_0+b_1L+b_2L^2+\cdots+\cdots=\sum_{i=0}^\infty b_iL^i$$`

`$$B(L)\varepsilon_t=b_0\varepsilon_t+b_1\varepsilon_{t-1}+b_2\varepsilon_{t-2}+\cdots=\sum_{i=0}^\infty b_i\varepsilon_{t-i}$$`

---
# Wold theorem 
`\(\{y_t \}\)` тэг дундажтай, стационарь цуваа бол 
`$$B(L)\varepsilon_t=b_0\varepsilon_t+b_1\varepsilon_{t-1}+b_2\varepsilon_{t-2}+\cdots=\sum_{i=0}^\infty b_i\varepsilon_{t-i}, \quad \varepsilon_t\sim WN(0,\sigma^2)$$`
хэлбэртэй бичиж болно. Энд `\(\sum_{i=0}^\infty b_i^2&lt;\infty\)`.

---
# General Linear Process
Волдын теоремийн нөхцлийг хангах
`$$B(L)\varepsilon_t=b_0\varepsilon_t+b_1\varepsilon_{t-1}+b_2\varepsilon_{t-2}+\cdots=\sum_{i=0}^\infty b_i\varepsilon_{t-i}, \quad \varepsilon_t\sim WN(0,\sigma^2)$$` 
 цувааг .hi-pink[ерөнхий шугаман процесс] гэдэг.

Моментууд
 - `\(\mathrm{E}(y_t)=0\)`
 - `\(\mathrm{Var}(y_t)=\sigma^2\sum b_i^2\)`
 
Нөхцөлт дундаж болон вариацын хувьд ( `\(\Omega_t=\{\varepsilon_t,\varepsilon_{t-1},\ldots \}\)`)

 - `\(\mathrm{E}(y_t|\Omega_{t−1})=\sum_{i=1}^\infty b_i\varepsilon_{t-i}\)`
 - `\(\mathrm{Var}(y_t|\Omega_{t−1} )=\mathrm{E}\{(y_t−\mathrm{E}(y_t|\Omega_{t−1}))^2|\Omega_{t−1}\}=\sigma^2\)`
 
---
# Үнэлгээ

.hi-pink[Дундаж] `\(\mu = \mathrm{E}{y_t}\)` түүвэр дэх аналог `$$\bar{y}=\frac{1}{T}\sum_{t=1}^Ty_t$$`

.hi-pink[Автокорреляци] `\(\rho(h) = \frac{\mathrm{Cov}(y_t,y_{t-h})}{\sqrt{\mathrm{Var}(y_t)\mathrm{Var}(y_{t-h})}}\)`

`$$\hat\rho(h)=\frac{\sum_{t=h+1}^T(y_t-\bar{y})(y_{t-h}-\bar{y})}{\sum_{t=1}^T(y_t-\bar{y})^2}$$`
Түүврийн автокорреляцийн функц буюу .hi[коррелограм] гэдэг

---
# Автокоррелляцийн тест

`\(H_0: \rho(h)=0\)` 
`$$\sqrt{T}\hat\rho(h) \to_d N(0, 1)$$`
`\(H_0: \rho(1)=0,...,\rho(m)=0\)` өөрөөр хэлбэл `\(y_t\)` автокорреляцигүй (white noise)

.hi-pink[Box-Pierce] `$$Q_{BP}=T\sum_{h=1}^m\hat\rho^2(h)\to_d \chi^2(m)$$`

.hi-pink[Ljung-Box] `$$Q_{LB}=T(T+2)\sum_{h=1}^m\frac{1}{T-h}\hat\rho^2(h)\to_d \chi^2(m)$$`
---
# Тухайн автокорреляц 
.hi[partial autocorrelation]

`\(y_t\)`-г `\(\{y_{t-1},...,y_{t-h}\}\)`-д регрессдэхэд гарсан `\(h\)`-р коэффициент `\(\hat{p}(h)\)`
 `$$\hat{y}_t=\hat{c}+\hat p(1)\hat{y}_{t-1}+\ldots+\hat p(h)\hat{y}_{t-h}$$`
Асимптотик тархалт түүврийн автокорреляцитай адилхан.

---
layout: false
class: clear
.hi[Quarterly Canadian Employment Index]

&lt;img src="slide5_files/figure-html/unnamed-chunk-1-1.svg" style="display: block; margin: auto;" /&gt;
---
# Autocorrelations

12-ухралттай автокорреляциуд

```r
acf &lt;- acf(ch7data$caemp, lag.max = 12, plot = FALSE)
print(acf)
```

```
#&gt; 
#&gt; Autocorrelations of series 'ch7data$caemp', by lag
#&gt; 
#&gt;     0     1     2     3     4     5     6     7     8     9    10    11 
#&gt; 1.000 0.959 0.897 0.829 0.754 0.678 0.602 0.527 0.452 0.374 0.292 0.211 
#&gt;    12 
#&gt; 0.137
```

стандарт алдаа

```r
1/sqrt(nrow(ch7data))  # 1.96*1/√T
```

```
#&gt; [1] 0.08574929
```


---
layout: false
class: clear

```r
plot(acf, main = "Autocorrelations")
```

&lt;img src="slide5_files/figure-html/unnamed-chunk-4-1.svg" style="display: block; margin: auto;" /&gt;
---
layout: false
class: clear

```r
plot(pacf(ch7data$caemp, lag.max = 12, plot = FALSE), main = "Partial Autocorrelations")
```

&lt;img src="slide5_files/figure-html/unnamed-chunk-5-1.svg" style="display: block; margin: auto;" /&gt;
---
# Autocorrelation Tests

```r
lb &lt;- rep(NA, 12)
bp &lt;- rep(NA, 12)
for(i in 1:12){
  bp[i] &lt;- Box.test(ch7data$caemp, lag = i, type = "Box-Pierce")$statistic
  lb[i] &lt;- Box.test(ch7data$caemp, lag = i, type = "Ljung-Box")$statistic
}
rbind(lb, bp)
```

```
#&gt;        [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
#&gt; lb 127.7312 240.4517 337.3193 418.2578 484.1585 536.4449 576.8441 606.7683
#&gt; bp 124.9545 234.4077 327.7655 405.1850 467.7429 516.9982 554.7627 582.5185
#&gt;        [,9]    [,10]    [,11]    [,12]
#&gt; lb 627.3982 640.0584 646.7420 649.5790
#&gt; bp 601.5039 613.0633 619.1172 621.6665
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
